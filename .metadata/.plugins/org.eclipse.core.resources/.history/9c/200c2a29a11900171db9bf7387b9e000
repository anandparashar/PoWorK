package globalResources;

import java.io.IOException;
import java.math.BigInteger;
import java.security.SecureRandom;

import org.bouncycastle.util.BigIntegers;

import edu.biu.scapi.primitives.*;
import edu.biu.scapi.primitives.dlog.*;
import edu.biu.scapi.primitives.dlog.openSSL.OpenSSLDlogECF2m;
import edu.biu.scapi.primitives.dlog.openSSL.OpenSSLDlogZpSafePrime;

public class Env_Variables {
	/*
	 * A class to store all the global variables that would be required across various classes of the application
	 * @author Anand
	 * 
	 */
	
	//TO-DO: Change dummy values 
	public BigInteger g ;
	public BigInteger q ;
	public BigInteger qMinusOne ;
	public BigInteger x ;
	public BigInteger w ;
	private DlogGroup dlog;
	
	public Env_Variables()
	{
		// initiate a discrete log group (in this case the OpenSSL implementation of the elliptic curve group K-233)
		
		try {
			dlog = new OpenSSLDlogZpSafePrime(256);
	
			// get the group generator and order
			GroupElement grpElement = dlog.getGenerator();
			this.g = new BigInteger(grpElement.toString());
			this.q = dlog.getOrder();
			System.out.println(dlog.isPrimeOrder());
			this.qMinusOne = this.q.subtract(BigInteger.ONE);
	
			// exponentiate g in r to receive a new group element
			GroupElement g1 = dlog.exponentiate(grpElement, createRandomExponentInGroup());
			// create a random group element
	
			GroupElement h = dlog.createRandomElement();
			// multiply elements
			GroupElement gMult = dlog.multiplyGroupElements(g1, h);
		} catch(Exception e){
			e.printStackTrace();
		}
	}
	
	public BigInteger createRandomExponentInGroup()
	{
		SecureRandom random = new SecureRandom();
		// create a random exponent r
		return BigIntegers.createRandomInRange(BigInteger.ZERO, this.qMinusOne, random);
	}
	
	public BigInteger createRandomGroupElement()
	{
		return BigInteger.ONE;
	}
	
	public static void main(String args[])
	{
		Env_Variables env = new Env_Variables();
	}
}

